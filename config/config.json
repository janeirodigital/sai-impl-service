{
  "@context": [
    "https://linkedsoftwaredependencies.org/bundles/npm/@janeirodigital/sai-server/^0.0.0/components/context.jsonld",
    "https://linkedsoftwaredependencies.org/bundles/npm/@digita-ai/handlersjs-core/^0.0.0/components/context.jsonld",
    "https://linkedsoftwaredependencies.org/bundles/npm/@digita-ai/handlersjs-http/^0.0.0/components/context.jsonld",
    "https://linkedsoftwaredependencies.org/bundles/npm/@janeirodigital/solid-redis-token-storage/^0.0.0/components/context.jsonld"
  ],
  "@graph": [
    {
      "@id": "urn:ssv:SessionManager",
      "@type": "SessionManager",
      "storage": {
        "@id": "urn:ssv:RedisStorage",
        "@type":"RedisSolidStorage"
      }
    },
    {
      "@id": "urn:solid:authorization-agent:default:Service",
      "@type": "NodeHttpServer",
      "port": "4000",
      "host": "0.0.0.0",
      "nodeHttpStreamsHandler": {
        "@type": "NodeHttpRequestResponseHandler",
        "httpHandler": {
          "@type": "HttpCorsRequestHandler",
          "handler": {
            "@type": "HttpSequenceHandler",
            "middleware": [
              {"@type": "UrlEncodedBodyParser"},
              {"@type": "AuthnMiddleware"},
              {
                "@type": "SolidSessionMiddleware",
                "manager": {"@id":"urn:ssv:SessionManager" }
              }
            ],
            "handler": {
              "@type": "RoutedHttpRequestHandler",
              "handlerControllerList": [
                {
                  "@type": "HttpHandlerController",
                  "label": "Http Controller",
                  "routes": [
                    {
                      "@type": "HttpHandlerRoute",
                      "path":  "/login",
                      "operations": [
                        {
                          "@type": "HttpHandlerOperation",
                          "method": "POST",
                          "publish": false
                        }
                      ],
                      "handler": {
                        "@type": "LoginHandler",
                        "sessionManager": { "@id": "urn:ssv:SessionManager" }
                      }
                    },
                    {
                      "@type": "HttpHandlerRoute",
                      "path":  "/agents/:uuid",
                      "operations": [
                        {
                          "@type": "HttpHandlerOperation",
                          "method": "GET",
                          "publish": false
                        }
                      ],
                      "handler": {
                        "@type": "AgentsHandler",
                        "sessionManager": { "@id": "urn:ssv:SessionManager" }
                      }
                    },
                    {
                      "@type": "HttpHandlerRoute",
                      "path":  "/agents/:uuid/redirect",
                      "operations": [
                        {
                          "@type": "HttpHandlerOperation",
                          "method": "GET",
                          "publish": false
                        }
                      ],
                      "handler": {
                        "@type": "LoginRedirectHandler",
                        "sessionManager": { "@id": "urn:ssv:SessionManager" }
                      }
                    }
                  ]
                }
              ]
            }
          }
        }
      }
    }
  ]
}
